{"version":3,"sources":["utils/geolocation.js","api/db.js","api/web.js","context/SnackBarProvider.js","components/home/Home.js","components/orders/hooks.js","components/orders/ImageList.js","components/orders/TaskList.js","components/orders/VideoList.js","components/orders/OrderDetail.js","components/orders/OrderList.js","components/orders/OrderIndex.js","App.js","index.js","components/header/Header.js","components/header/HeaderDrawer.js","components/header/HeaderWifiIcon.js"],"names":["convertDMSToDD","degrees","minutes","seconds","direction","dd","getGeolocationFromImage","imageFile","Promise","resolve","reject","EXIF","allMetaData","this","console","log","tags","GPSLatitude","GPSLatitudeRef","GPSLongitude","GPSLongitudeRef","latDegree","latMinute","latSecond","latDirection","lonDegree","lonMinute","lonSecond","lonDirection","lat","lng","origin","parseGeolocationTags","getGeoloacationFromDevice","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","err","timeout","shortid","PouchDB","plugin","PouchFindPlugin","on","dbName","syncMetadataStore","ordersStore","imagesStore","videosStore","tasksStore","DEFAULT_SYNC_METADATA","_id","downloadDisabled","downloadedAt","uploadDisabled","uploadedAt","deleteDisabled","deletedAt","getSyncMetadataStore","a","forceNew","getOrdersStore","createIndex","index","fields","getTasksStore","getImagesStore","getVideosStore","cleanDatabases","cleanDatabase","metadataResult","orderResult","taskResult","imagesResult","videosResult","metadata","ok","orders","tasks","images","video","getStoreFn","store","destroy","result","syncToRemote","syncStoreToRemote","remoteName","getLocalStoreFn","remoteDB","process","info","localStore","replicate","to","error","getSyncMetadata","db","get","name","updateSyncMetadata","data","previous","doc","_rev","put","getOrders","find","selector","createdAt","$gte","sort","docs","getOrderById","id","addOrder","order","getTasksByOrderId","orderId","response","ids","map","allDocs","keys","include_docs","rows","row","getTaskById","addTask","task","Date","toISOString","completed","updateTask","deleteTask","remove","getImagesByOrderId","attachments","binary","getImageById","addImage","type","location","_attachments","file","content_type","deleteImage","image","getVideosByOrderId","getVideoById","addVideo","deleteVideo","REST_API_URL","fetchOrders","fetch","json","fetchTasksByOrderId","SnackBarContext","createContext","SnackBarProvider","children","useState","severity","setSeverity","message","setMessage","open","setOpen","addAlert","alert","handleClose","event","reason","value","showInfoAlert","showSuccessAlert","showWarningAlert","showErrorAlert","Provider","Snackbar","autoHideDuration","onClose","Alert","elevation","variant","Home","useContext","syncMetadata","setSyncMetadata","loading","setLoading","useEffect","fetchSyncMetadata","onClickDownload","length","all","ordersSavedToDb","orderIds","flat","updatedMetadata","onClickUpload","onClickDelete","Grid","container","spacing","item","xs","Typography","Button","color","startIcon","onClick","disabled","justify","alignItems","CircularProgress","size","style","marginTop","useStyles","makeStyles","theme","inputFile","display","icon","backdrop","zIndex","drawer","backdropContent","maxWidth","maxHeight","ImageList","classes","initialValue","isError","setIsError","isLoading","setIsLoading","setData","shouldReload","setShouldReload","loadData","now","valueOf","useGetImagesByOrderId","reload","selectedImage","setSelectedImage","handleOpenImage","onChangeImageUpload","element","document","getElementById","files","handleDeleteImage","Backdrop","className","src","alt","accept","onChange","htmlFor","IconButton","component","Paper","GridList","cellHeight","cols","GridListTile","key","height","ListSubheader","backgroundColor","imageURL","URL","createObjectURL","GridListTileBar","title","subtitle","actionIcon","TaskList","useGetTasksByOrderId","newTaskDescription","setNewTaskDescription","handleAddTask","description","handleCompleteTask","target","checked","handleDeleteTask","Dialog","fullWidth","DialogTitle","DialogContent","TextField","autoFocus","label","DialogActions","List","subheader","ListItem","Switch","edge","ListItemText","primary","ListItemSecondaryAction","VideoList","useGetVideosByOrderId","videos","selectedVideo","setSelectedVideo","handleOpenVideo","onChangeVideoUpload","handleDeleteVideo","controls","videoURL","OrderDetail","useParams","useGetOrderById","OrderList","url","useRouteMatch","useGetOrders","button","Link","secondary","station","OrderRouter","path","exact","main","paddingTop","App","basename","CssBaseline","Header","Container","ReactDOM","render","AddToHomeScreen","brandName","root","flexGrow","menuButton","marginRight","iOS","browser","test","userAgent","toggleDrawer","anchor","onOpen","disableBackdropTransition","disableDiscovery","aria-label","ListItemLink","props","renderLink","React","useMemo","forwardRef","itemProps","ref","width","HeaderDrawer","HeaderWifiIcon","isOnline","setIsOnline","window","addEventListener","checkInternet","onLine","method","mode","then","resp","catch","e"],"mappings":"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","file":"static/js/main.c7f011ee.chunk.js","sourcesContent":["import * as EXIF from 'exif-js';\n\nfunction convertDMSToDD(degrees, minutes, seconds, direction) {\n  let dd = degrees + minutes / 60 + seconds / 3600;\n  if (direction === 'S' || direction === 'W') {\n    dd = dd * -1;\n  }\n  return dd;\n}\n\nfunction parseGeolocationTags(tags) {\n  const {\n    GPSLatitude,\n    GPSLatitudeRef,\n    GPSLongitude,\n    GPSLongitudeRef,\n  } = tags;\n\n  if (\n    !GPSLatitude ||\n    !GPSLatitudeRef ||\n    !GPSLongitude ||\n    !GPSLongitudeRef\n  ) {\n    return null;\n  }\n\n  const latDegree = GPSLatitude[0];\n  const latMinute = GPSLatitude[1];\n  const latSecond = GPSLatitude[2];\n  const latDirection = GPSLatitudeRef;\n\n  const lonDegree = GPSLongitude[0];\n  const lonMinute = GPSLongitude[1];\n  const lonSecond = GPSLongitude[2];\n  const lonDirection = GPSLongitudeRef;\n\n  const lat = convertDMSToDD(\n    latDegree,\n    latMinute,\n    latSecond,\n    latDirection,\n  );\n\n  const lng = convertDMSToDD(\n    lonDegree,\n    lonMinute,\n    lonSecond,\n    lonDirection,\n  );\n\n  return {\n    lat,\n    lng,\n    origin: 'EXIF',\n  };\n}\n\nexport const getGeolocationFromImage = (imageFile) => {\n  return new Promise((resolve, reject) => {\n    EXIF.getData(imageFile, function () {\n      const allMetaData = EXIF.getAllTags(this);\n      console.log('==>> EXIF ALL', allMetaData);\n      resolve(parseGeolocationTags(allMetaData));\n    });\n  });\n};\n\nexport const getGeoloacationFromDevice = () => {\n  return new Promise((resolve, reject) => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(\n        // success\n        (position) => {\n          console.log(position);\n          resolve({\n            lat: position.coords.latitude,\n            lng: position.coords.longitude,\n            origin: 'DEVICE',\n          });\n        },\n        // error\n        (err) => {\n          // reject(err);\n          resolve(null);\n          // error.code can be:\n          //   0: unknown error\n          //   1: permission denied\n          //   2: position unavailable (error response from location provider)\n          //   3: timed out\n        },\n        // options\n        {\n          timeout: 10000,\n          // enableHighAccuracy: true, // slower to resolve and uses more battery\n        },\n      );\n    } else {\n      console.log(\n        'Geolocation is not supported for this Browser/OS.',\n      );\n      reject();\n    }\n  });\n};\n","import PouchDB from 'pouchdb';\nimport PouchFindPlugin from 'pouchdb-find';\nimport * as shortid from 'shortid';\nimport { getGeoloacationFromDevice, getGeolocationFromImage } from '../utils/geolocation';\n\nshortid.characters(\n  '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$@',\n);\n\n// enable queries\n// https://pouchdb.com/guides/mango-queries.html\nPouchDB.plugin(PouchFindPlugin);\n\nPouchDB.on('destroyed', function (dbName) {\n  // called whenever a db is destroyed.\n  console.log('==>> POUCHEDB destroyed', dbName);\n});\n\nconst REMOTE_DB_URL = process.env.REACT_APP_REMOTE_DATABASE_ENDPOINT;\n\nconst SYNC_METADATA = 'sync-metadata';\nconst ORDERS = 'orders';\nconst TASKS = 'tasks';\nconst IMAGES = 'images';\nconst VIDEOS = 'videos';\n\nexport const DEFAULT_SYNC_METADATA = {\n  _id: 'default',\n  downloadDisabled: false,\n  downloadedAt: '',\n  uploadDisabled: true,\n  uploadedAt: '',\n  deleteDisabled: true,\n  deletedAt: '',\n};\n\n// ####################################\n// DATABASES\n// ####################################\n\nlet syncMetadataStore;\nlet ordersStore;\nlet imagesStore;\nlet videosStore;\nlet tasksStore;\n\nasync function getSyncMetadataStore(forceNew = false) {\n  if (!syncMetadataStore || forceNew) {\n    syncMetadataStore = new PouchDB(SYNC_METADATA);\n  }\n  return syncMetadataStore;\n}\n\nasync function getOrdersStore(forceNew = false) {\n  if (!ordersStore || forceNew) {\n    ordersStore = new PouchDB(ORDERS);\n\n    await ordersStore.createIndex({\n      index: { fields: ['createdAt'] },\n    });\n  }\n  return ordersStore;\n}\n\nasync function getTasksStore(forceNew = false) {\n  if (!tasksStore || forceNew) {\n    tasksStore = new PouchDB(TASKS);\n\n    await tasksStore.createIndex({\n      index: { fields: ['createdAt', 'orderId'] },\n    });\n  }\n  return tasksStore;\n}\n\nasync function getImagesStore(forceNew = false) {\n  if (!imagesStore || forceNew) {\n    imagesStore = new PouchDB(IMAGES);\n\n    await imagesStore.createIndex({\n      index: { fields: ['createdAt', 'orderId'] },\n    });\n  }\n  return imagesStore;\n}\n\nasync function getVideosStore(forceNew = false) {\n  if (!videosStore || forceNew) {\n    videosStore = new PouchDB(VIDEOS);\n\n    await videosStore.createIndex({\n      index: { fields: ['createdAt', 'orderId'] },\n    });\n  }\n  return videosStore;\n}\n\nexport async function cleanDatabases() {\n  const metadataResult = await cleanDatabase(getSyncMetadataStore);\n  const orderResult = await cleanDatabase(getOrdersStore);\n  const taskResult = await cleanDatabase(getTasksStore);\n  const imagesResult = await cleanDatabase(getImagesStore);\n  const videosResult = await cleanDatabase(getVideosStore);\n\n  return {\n    metadata: metadataResult.ok,\n    orders: orderResult.ok,\n    tasks: taskResult.ok,\n    images: imagesResult.ok,\n    video: videosResult.ok,\n  };\n}\n\nasync function cleanDatabase(getStoreFn) {\n  // delete the store\n  const store = await getStoreFn();\n  const result = await store.destroy();\n  if (result.ok) {\n    // re-create\n    await getStoreFn(true);\n  }\n  return result;\n}\n\n// ####################################\n// SYNC LOCAL DATA TO SERVER\n// ####################################\n\nexport const syncToRemote = async () => {\n  // tasks\n  await syncStoreToRemote(TASKS, getTasksStore);\n\n  // images\n  await syncStoreToRemote(IMAGES, getImagesStore);\n\n  // videos\n  await syncStoreToRemote(VIDEOS, getVideosStore);\n\n  return Promise.resolve();\n};\n\nconst syncStoreToRemote = async (remoteName, getLocalStoreFn) => {\n  const remoteDB = new PouchDB(\n    `${REMOTE_DB_URL}/${remoteName}`,\n  );\n  console.log(await remoteDB.info());\n\n  const localStore = await getLocalStoreFn();\n\n  return new Promise((resolve, reject) => {\n    localStore.replicate\n      .to(remoteDB)\n      .on('complete', () => {\n        console.log(remoteName, 'SYNC COMPLETED');\n        resolve();\n      })\n      .on('error', (err) => {\n        console.log(remoteName, 'SYNC ERROR');\n        console.error(err);\n        reject(err);\n      });\n  });\n};\n\n// ####################################\n// SYNC METADATA STORE\n// ####################################\n\nexport async function getSyncMetadata() {\n  try {\n    const db = await getSyncMetadataStore();\n    return await db.get('default');\n  } catch (err) {\n    if (err && err.name === 'not_found') {\n      return DEFAULT_SYNC_METADATA;\n    }\n  }\n}\n\nexport async function updateSyncMetadata(data) {\n  const db = await getSyncMetadataStore();\n  const previous = await getSyncMetadata();\n  const doc =\n    previous && previous._rev\n      ? { ...data, _rev: previous._rev }\n      : data;\n  // update\n  await db.put(doc);\n  // return updated version\n  return await db.get('default');\n}\n\n// ####################################\n// ORDERS STORE\n// ####################################\n\nexport async function getOrders() {\n  const db = await getOrdersStore();\n  const result = await db.find({\n    selector: {\n      createdAt: { $gte: null },\n    },\n    sort: ['createdAt'],\n  });\n  return result.docs;\n}\n\nexport async function getOrderById(id) {\n  const db = await getOrdersStore();\n  return await db.get(id);\n}\n\nexport async function addOrder(order) {\n  const db = await getOrdersStore();\n  // save\n  const result = await db.put(order);\n  // return the most recebt version\n  return getOrderById(result.id);\n}\n\n// ####################################\n// TASKS STORE\n// ####################################\n\nexport async function getTasksByOrderId(orderId) {\n  const db = await getTasksStore();\n  const response = await db.find({\n    selector: {\n      orderId,\n      createdAt: { $gte: null },\n    },\n    sort: ['createdAt'],\n  });\n  // collect all ids\n  const ids = response.docs.map((doc) => doc._id);\n  // get by ids\n  const result = await db.allDocs({\n    keys: ids,\n    include_docs: true,\n  });\n  return result.rows.map((row) => row.doc);\n}\n\nexport async function getTaskById(id) {\n  const db = await getTasksStore();\n  return await db.get(id);\n}\n\nexport async function addTask(task) {\n  const db = await getTasksStore();\n  // save\n  const result = await db.put({\n    ...task,\n    _id: shortid.generate(),\n    createdAt: new Date().toISOString(),\n    completed: false,\n  });\n  // return saved doc\n  return getTaskById(result.id);\n}\n\nexport async function updateTask(task) {\n  const db = await getTasksStore();\n  // get task\n  const { _rev } = await getTaskById(task._id);\n  // save\n  const result = await db.put({\n    ...task,\n    _rev,\n  });\n  // return saved doc\n  return getTaskById(result.id);\n}\n\nexport async function deleteTask(task) {\n  const db = await getTasksStore();\n  // load latest rev\n  const doc = await db.get(task._id);\n  // remove\n  return db.remove(doc);\n}\n\n// ####################################\n// IMAGES STORE\n// ####################################\n\nexport async function getImagesByOrderId(orderId) {\n  const db = await getImagesStore();\n  // find does not return the attachments\n  const response = await db.find({\n    selector: {\n      orderId,\n      createdAt: { $gte: null },\n    },\n    sort: ['createdAt'],\n  });\n  // collect all ids\n  const ids = response.docs.map((doc) => doc._id);\n  // get by ids\n  const result = await db.allDocs({\n    keys: ids,\n    include_docs: true,\n    attachments: true,\n    binary: true,\n  });\n  return result.rows.map((row) => row.doc);\n}\n\nexport async function getImageById(id) {\n  const db = await getImagesStore();\n  return await db.get(id, {\n    attachments: true,\n    binary: true,\n  });\n}\n\nexport async function addImage(orderId, imageFile) {\n  const db = await getImagesStore();\n  const { name, type } = imageFile;\n  // try to retrieve location from EXIF tags\n  let location = await getGeolocationFromImage(imageFile);\n  // ask current location from device\n  if (!location) {\n    location = await getGeoloacationFromDevice();\n  }\n  // inline attachment\n  const doc = {\n    _id: shortid.generate(),\n    orderId,\n    name,\n    location,\n    createdAt: new Date().toISOString(),\n    _attachments: {\n      file: {\n        content_type: type,\n        data: imageFile,\n      },\n    },\n  };\n  // save\n  const result = await db.put(doc);\n  // return saved image\n  return getImageById(result.id);\n}\n\nexport async function deleteImage(image) {\n  const db = await getImagesStore();\n  // load latest rev\n  const doc = await db.get(image._id);\n  // remove\n  return db.remove(doc);\n}\n\n// ####################################\n// VIDEOS STORE\n// ####################################\n\nexport async function getVideosByOrderId(orderId) {\n  const db = await getVideosStore();\n  // find does not return the attachments\n  const response = await db.find({\n    selector: {\n      orderId,\n      createdAt: { $gte: null },\n    },\n    sort: ['createdAt'],\n  });\n  // collect all ids\n  const ids = response.docs.map((doc) => doc._id);\n  // get by ids\n  const result = await db.allDocs({\n    keys: ids,\n    include_docs: true,\n    attachments: true,\n    binary: true,\n  });\n  return result.rows.map((row) => row.doc);\n}\n\nexport async function getVideoById(id) {\n  const db = await getVideosStore();\n  return await db.get(id, {\n    attachments: true,\n    binary: true,\n  });\n}\n\nexport async function addVideo(orderId, imageFile) {\n  const db = await getVideosStore();\n  const { name, type } = imageFile;\n  // inline attachment\n  const doc = {\n    _id: shortid.generate(),\n    orderId,\n    name,\n    createdAt: new Date().toISOString(),\n    _attachments: {\n      file: {\n        content_type: type,\n        data: imageFile,\n      },\n    },\n  };\n  // save\n  const result = await db.put(doc);\n  // return saved image\n  return getVideoById(result.id);\n}\n\nexport async function deleteVideo(video) {\n  const db = await getVideosStore();\n  // load latest rev\n  const doc = await db.get(video._id);\n  // remove\n  return db.remove(doc);\n}\n","// web fetch\nconst REST_API_URL = process.env.REACT_APP_REST_API_ENDPOINT;\n\nexport async function fetchOrders() {\n    const response = await fetch(\n        `${REST_API_URL}/orders`,\n    );\n    return response.json();\n}\n\nexport async function fetchOrderById(id) {\n    const response = await fetch(\n        `${REST_API_URL}/orders/${id}`,\n    );\n    return response.json();\n}\n\nexport async function fetchTasksByOrderId(orderId) {\n    const response = await fetch(\n        `${REST_API_URL}/tasks/${orderId}`,\n    );\n    return response.json();\n}\n","import { Snackbar } from '@material-ui/core';\nimport Alert from '@material-ui/lab/Alert';\nimport React, { createContext, useState } from 'react';\n\nexport const SnackBarContext = createContext();\n\nexport function SnackBarProvider({ children }) {\n  const [severity, setSeverity] = useState('info');\n  const [message, setMessage] = useState('');\n  const [open, setOpen] = useState(false);\n\n  const addAlert = (alert, severity) => {\n    setMessage(alert);\n    setSeverity('success');\n    setOpen(true);\n  };\n\n  const showInfoAlert = (alert) => addAlert(alert, 'info');\n  const showSuccessAlert = (alert) => addAlert(alert, 'success');\n  const showWarningAlert = (alert) => addAlert(alert, 'warning');\n  const showErrorAlert = (alert) => addAlert(alert, 'error');\n\n  const handleClose = (event, reason) => {\n    if (reason === 'clickaway') {\n      return;\n    }\n    setOpen(false);\n  };\n\n  const value = {\n    showInfoAlert,\n    showSuccessAlert,\n    showWarningAlert,\n    showErrorAlert,\n  };\n\n  return (\n    <>\n      <SnackBarContext.Provider value={value}>\n        {children}\n        <Snackbar\n          message={message}\n          open={open}\n          autoHideDuration={6000}\n          onClose={handleClose}\n        >\n          <Alert\n            elevation={6}\n            variant=\"filled\"\n            onClose={handleClose}\n            severity={severity}\n          >\n            {message}\n          </Alert>\n        </Snackbar>\n      </SnackBarContext.Provider>\n    </>\n  );\n}\n","import { Button, CircularProgress, Grid, Typography } from '@material-ui/core';\nimport CloudDownloadIcon from '@material-ui/icons/CloudDownload';\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport React, { useContext, useEffect, useState } from 'react';\nimport { addOrder, addTask, cleanDatabases, DEFAULT_SYNC_METADATA, getSyncMetadata, syncToRemote, updateSyncMetadata } from '../../api/db';\nimport { fetchOrders, fetchTasksByOrderId } from '../../api/web';\nimport { SnackBarContext } from '../../context/SnackBarProvider';\n\nexport default function Home() {\n  const { showSuccessAlert, showErrorAlert } = useContext(\n    SnackBarContext,\n  );\n\n  // load sync metadata\n  const [syncMetadata, setSyncMetadata] = useState(\n    DEFAULT_SYNC_METADATA,\n  );\n\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    async function fetchSyncMetadata() {\n      try {\n        const response = await getSyncMetadata();\n        setSyncMetadata(response);\n      } catch (err) {\n        console.error(err);\n      }\n    }\n    fetchSyncMetadata();\n  }, []);\n\n  const onClickDownload = async (event) => {\n    try {\n      setLoading(true);\n\n      // fetch data from web api\n      const orders = await fetchOrders();\n\n      if (orders.length > 0) {\n        const ordersSavedToDb = await Promise.all(\n          orders.map((order) =>\n            // pouchdb needs an _id as key\n            addOrder({ ...order, _id: order.id }),\n          ),\n        );\n\n        const orderIds = ordersSavedToDb.map((order) => order._id);\n\n        const tasks = await Promise.all(\n          orderIds.map((orderId) => fetchTasksByOrderId(orderId)),\n        );\n\n        // pouchdb needs an _id as key\n        await Promise.all(\n          tasks\n            .flat()\n            .map((task) => addTask({ ...task, _id: addTask.id })),\n        );\n\n        // save metadata in the database\n        const updatedMetadata = await updateSyncMetadata({\n          ...syncMetadata,\n          downloadDisabled: true,\n          uploadDisabled: false,\n          deleteDisabled: false,\n        });\n\n        // update sync metadata state\n        setSyncMetadata(updatedMetadata);\n      }\n\n      showSuccessAlert('Data loaded from server successfuly');\n    } catch (err) {\n      showErrorAlert('Error loading data from server');\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const onClickUpload = async (event) => {\n    try {\n      setLoading(true);\n\n      await syncToRemote();\n\n      // save metadata in the database\n      const updatedMetadata = await updateSyncMetadata({\n        ...syncMetadata,\n        downloadDisabled: true,\n        uploadDisabled: true,\n        deleteDisabled: false,\n      });\n\n      // // update sync metadata state\n      setSyncMetadata(updatedMetadata);\n\n      showSuccessAlert('Data synced back to server successfuly');\n    } catch (err) {\n      showErrorAlert('Error syncing data back to server');\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const onClickDelete = async (event) => {\n    try {\n      setLoading(true);\n\n      // delete databases\n      const result = await cleanDatabases();\n      console.log(result);\n\n      // restore sync metadata default\n      setSyncMetadata(await getSyncMetadata());\n\n      showSuccessAlert('Local database cleaned successfuly');\n    } catch (err) {\n      showErrorAlert('Error cleaning local database');\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div>\n      <Grid container spacing={2}>\n        <Grid item xs={12}>\n          <Typography variant=\"h5\">Home</Typography>\n        </Grid>\n        <Grid item xs={12}>\n          <Button\n            variant=\"contained\"\n            color=\"default\"\n            startIcon={<CloudDownloadIcon />}\n            onClick={onClickDownload}\n            disabled={syncMetadata.downloadDisabled || loading}\n          >\n            Load data from server\n          </Button>\n        </Grid>\n        <Grid item xs={12}>\n          <Button\n            variant=\"contained\"\n            color=\"default\"\n            startIcon={<CloudUploadIcon />}\n            onClick={onClickUpload}\n            disabled={syncMetadata.uploadDisabled || loading}\n          >\n            Sync local data to server\n          </Button>\n        </Grid>\n        <Grid item xs={12}>\n          <Button\n            variant=\"contained\"\n            color=\"default\"\n            startIcon={<DeleteIcon />}\n            onClick={onClickDelete}\n            disabled={syncMetadata.deleteDisabled || loading}\n          >\n            Clean my local data\n          </Button>\n        </Grid>\n        {loading && (\n          <Grid\n            item\n            xs={12}\n            container\n            direction=\"column\"\n            justify=\"center\"\n            alignItems=\"center\"\n          >\n            <CircularProgress size={40} style={{ marginTop: 50 }} />\n          </Grid>\n        )}\n      </Grid>\n    </div>\n  );\n}\n","import { useEffect, useState } from 'react';\nimport { getImagesByOrderId, getOrderById, getOrders, getTasksByOrderId, getVideosByOrderId } from '../../api/db';\n\nexport const useGetOrders = (initialValue) => {\n  const [isError, setIsError] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [data, setData] = useState(initialValue);\n  const [shouldReload, setShouldReload] = useState(0);\n\n  useEffect(() => {\n    async function loadData() {\n      setIsLoading(true);\n      setIsError(false);\n      try {\n        setData(await getOrders());\n      } catch (err) {\n        console.error(err);\n        setIsError(true);\n      }\n      setIsLoading(false);\n    }\n\n    loadData();\n  }, [shouldReload]);\n\n  function reload() {\n    setShouldReload(Date.now().valueOf());\n  }\n\n  return [data, isLoading, isError, reload];\n};\n\nexport const useGetOrderById = (id, initialValue) => {\n  const [isError, setIsError] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [data, setData] = useState(initialValue);\n  const [shouldReload, setShouldReload] = useState(0);\n\n  useEffect(() => {\n    async function loadData() {\n      setIsLoading(true);\n      setIsError(false);\n      try {\n        setData(await getOrderById(id));\n      } catch (err) {\n        console.error(err);\n        setIsError(true);\n      }\n      setIsLoading(false);\n    }\n\n    loadData();\n  }, [id, shouldReload]);\n\n  function reload() {\n    setShouldReload(Date.now().valueOf());\n  }\n\n  return [data, isLoading, isError, reload];\n};\n\nexport const useGetTasksByOrderId = (orderId, initialValue) => {\n  const [isError, setIsError] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [data, setData] = useState(initialValue);\n  const [shouldReload, setShouldReload] = useState(0);\n\n  useEffect(() => {\n    async function loadData() {\n      setIsLoading(true);\n      setIsError(false);\n      try {\n        setData(await getTasksByOrderId(orderId));\n      } catch (err) {\n        console.error(err);\n        setIsError(true);\n      }\n      setIsLoading(false);\n    }\n\n    loadData();\n  }, [orderId, shouldReload]);\n\n  function reload() {\n    setShouldReload(Date.now().valueOf());\n  }\n\n  return [data, isLoading, isError, reload];\n};\n\nexport const useGetImagesByOrderId = (orderId, initialValue) => {\n  const [isError, setIsError] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [data, setData] = useState(initialValue);\n  const [shouldReload, setShouldReload] = useState(0);\n\n  useEffect(() => {\n    async function loadData() {\n      setIsLoading(true);\n      setIsError(false);\n      try {\n        setData(await getImagesByOrderId(orderId));\n      } catch (err) {\n        console.error(err);\n        setIsError(true);\n      }\n      setIsLoading(false);\n    }\n\n    loadData();\n  }, [orderId, shouldReload]);\n\n  function reload() {\n    setShouldReload(Date.now().valueOf());\n  }\n\n  return [data, isLoading, isError, reload];\n};\n\nexport const useGetVideosByOrderId = (orderId, initialValue) => {\n  const [isError, setIsError] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [data, setData] = useState(initialValue);\n  const [shouldReload, setShouldReload] = useState(0);\n\n  useEffect(() => {\n    async function loadData() {\n      setIsLoading(true);\n      setIsError(false);\n      try {\n        setData(await getVideosByOrderId(orderId));\n      } catch (err) {\n        console.error(err);\n        setIsError(true);\n      }\n      setIsLoading(false);\n    }\n\n    loadData();\n  }, [orderId, shouldReload]);\n\n  function reload() {\n    setShouldReload(Date.now().valueOf());\n  }\n\n  return [data, isLoading, isError, reload];\n};\n","import { Backdrop, Grid, GridList, GridListTile, GridListTileBar, IconButton, ListSubheader, makeStyles, Paper } from '@material-ui/core';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport PhotoCamera from '@material-ui/icons/PhotoCamera';\nimport React, { useContext, useState } from 'react';\nimport { addImage, deleteImage } from '../../api/db';\nimport { SnackBarContext } from '../../context/SnackBarProvider';\nimport { useGetImagesByOrderId } from './hooks';\n\nconst useStyles = makeStyles((theme) => ({\n  inputFile: {\n    display: 'none',\n  },\n  icon: {\n    color: 'rgba(255, 255, 255, 0.54)',\n  },\n  backdrop: {\n    zIndex: theme.zIndex.drawer + 1,\n    color: '#fff',\n  },\n  backdropContent: {\n    maxWidth: '95%',\n    maxHeight: '95%',\n  },\n}));\n\nexport default function ImageList({ orderId }) {\n  const classes = useStyles();\n\n  const { showSuccessAlert, showErrorAlert } = useContext(\n    SnackBarContext,\n  );\n\n  const [images, isLoading, isError, reload] = useGetImagesByOrderId(\n    orderId,\n    [],\n  );\n  const [open, setOpen] = useState(false);\n  const [selectedImage, setSelectedImage] = useState(false);\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const handleOpenImage = (image) => () => {\n    // clicked image\n    setSelectedImage(image);\n    // open backdrop\n    setOpen(!open);\n  };\n\n  const onChangeImageUpload = async (event) => {\n    try {\n      const element = document.getElementById('input-image-file');\n      if (element.files && element.files[0]) {\n        await addImage(orderId, element.files[0]);\n        reload();\n        // show message\n        showSuccessAlert('Image uploaded');\n      }\n    } catch (err) {\n      showErrorAlert(`Error uploading image (${err.message})`);\n    }\n  };\n\n  const handleDeleteImage = (image) => async (event) => {\n    try {\n      // delete\n      await deleteImage(image);\n      // reload images\n      reload();\n      // show message\n      showSuccessAlert('Image removed');\n    } catch (err) {\n      showErrorAlert(`Error removing image (${err.message})`);\n    }\n  };\n\n  // const onClickMap = (data) => (event) => {\n  //   console.log('==>> onClickMap', data);\n\n  //   if (!data) {\n  //     return;\n  //   }\n\n  //   const { lat, lng } = data;\n\n  //   if (['iPhone', 'iPad', 'iPod'].includes(navigator.platform)) {\n  //     const win = window.open(\n  //       `maps://maps.google.com/maps?daddr=${lat},${lng}&amp;ll=`,\n  //       '_top',\n  //     );\n  //     return win.focus();\n  //   }\n  //   /* default to Google */\n  //   const win = window.open(\n  //     `https://maps.google.com/maps?q=${lat},${lng}`,\n  //     '_blank',\n  //   );\n  //   return win.focus();\n  // };\n\n  return (\n    <>\n      {/* BACKDROP */}\n\n      <Backdrop\n        className={classes.backdrop}\n        open={open}\n        onClick={handleClose}\n      >\n        {selectedImage && (\n          <img\n            className={classes.backdropContent}\n            src={selectedImage}\n            alt=\"\"\n          />\n        )}\n      </Backdrop>\n\n      {/* ACTIONS */}\n\n      <Grid item container xs={12} direction=\"row\" justify=\"flex-end\">\n        <Grid item>\n          <input\n            type=\"file\"\n            accept=\"image/*\"\n            id=\"input-image-file\"\n            className={classes.inputFile}\n            onChange={onChangeImageUpload}\n          />\n          <label htmlFor=\"input-image-file\">\n            <IconButton color=\"primary\" component=\"span\">\n              <PhotoCamera />\n            </IconButton>\n          </label>\n        </Grid>\n      </Grid>\n\n      {/* LIST */}\n\n      <Grid item xs={12}>\n        <Paper elevation={1}>\n          <GridList cellHeight={180} cols={3}>\n            <GridListTile\n              key=\"subheader-image\"\n              cols={3}\n              style={{ height: 'auto' }}\n            >\n              <ListSubheader\n                component=\"div\"\n                color=\"primary\"\n                style={{ backgroundColor: '#E5E5E5' }}\n              >\n                Images\n                {!isLoading && images.length === 0\n                  ? ' (No items to display)'\n                  : ''}\n                {isLoading ? ' (Loading...)' : ''}\n                {isError ? ' (Error loading images)' : ''}\n              </ListSubheader>\n            </GridListTile>\n\n            {images &&\n              images.map((image) => {\n                const imageURL = URL.createObjectURL(\n                  image._attachments.file.data,\n                );\n                return (\n                  <GridListTile\n                    key={image._id}\n                    cols={1}\n                    onClick={handleOpenImage(imageURL)}\n                  >\n                    <img src={imageURL} alt={image.name} />\n                    <GridListTileBar\n                      title={image.name}\n                      subtitle={\n                        image.location\n                          ? `${image.location.lat}, ${image.location.lng}`\n                          : 'No location'\n                      }\n                      actionIcon={\n                        <IconButton\n                          className={classes.icon}\n                          onClick={handleDeleteImage(image)}\n                        >\n                          <DeleteIcon />\n                        </IconButton>\n                      }\n                    />\n                  </GridListTile>\n                );\n              })}\n          </GridList>\n        </Paper>\n      </Grid>\n    </>\n  );\n}\n","import { Button, Dialog, DialogActions, DialogContent, DialogTitle, Grid, IconButton, List, ListItem, ListItemSecondaryAction, ListItemText, ListSubheader, Paper, Switch, TextField } from '@material-ui/core';\nimport AddIcon from '@material-ui/icons/Add';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport React, { useContext, useState } from 'react';\nimport { addTask, deleteTask, updateTask } from '../../api/db';\nimport { SnackBarContext } from '../../context/SnackBarProvider';\nimport { useGetTasksByOrderId } from './hooks';\n\nexport default function TaskList({ orderId }) {\n  const { showSuccessAlert, showErrorAlert } = useContext(\n    SnackBarContext,\n  );\n  const [tasks, isLoading, isError, reload] = useGetTasksByOrderId(\n    orderId,\n    [],\n  );\n  const [open, setOpen] = useState(false);\n  const [newTaskDescription, setNewTaskDescription] = useState(false);\n\n  const onChange = (event) => {\n    setNewTaskDescription(event.target.value);\n  };\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const handleAddTask = async () => {\n    try {\n      // save task\n      await addTask({\n        orderId,\n        description: newTaskDescription,\n      });\n      // close dialog\n      handleClose();\n      // reload tasks\n      reload();\n      // show message\n      showSuccessAlert('Task added');\n    } catch (err) {\n      showErrorAlert(`Error addding task (${err.message})`);\n    }\n  };\n\n  const handleCompleteTask = (task) => async (event) => {\n    try {\n      await updateTask({\n        ...task,\n        completed: event.target.checked,\n      });\n      reload();\n    } catch (err) {\n      showErrorAlert(`Error completiing task (${err.message})`);\n    }\n  };\n\n  const handleDeleteTask = (task) => async (event) => {\n    try {\n      // delete task\n      await deleteTask(task);\n      // reload tasks\n      reload();\n      // show message\n      showSuccessAlert('Task removed');\n    } catch (err) {\n      showErrorAlert(`Error removing task (${err.message})`);\n    }\n  };\n\n  return (\n    <>\n      {/* ACTIONS */}\n\n      <Grid item container xs={12} direction=\"row\" justify=\"flex-end\">\n        <Grid item>\n          <IconButton\n            color=\"primary\"\n            component=\"span\"\n            onClick={handleClickOpen}\n          >\n            <AddIcon />\n          </IconButton>\n        </Grid>\n      </Grid>\n\n      {/* DIALOG */}\n      <Dialog open={open} onClose={handleClose} fullWidth>\n        <DialogTitle style={{ backgroundColor: '#E5E5E5' }}>\n          New Task\n        </DialogTitle>\n        <DialogContent>\n          <TextField\n            autoFocus\n            id=\"description\"\n            label=\"Description\"\n            fullWidth\n            onChange={onChange}\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose} color=\"primary\">\n            Cancel\n          </Button>\n          <Button onClick={handleAddTask} color=\"primary\">\n            Add Task\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* LIST */}\n\n      <Grid item xs={12}>\n        <Paper elevation={1}>\n          <List\n            subheader={\n              <ListSubheader\n                color=\"primary\"\n                style={{ backgroundColor: '#E5E5E5' }}\n              >\n                Tasks\n                {!isLoading && tasks.length === 0\n                  ? ' (No items to display)'\n                  : ''}\n                {isLoading ? ' (Loading...)' : ''}\n                {isError ? ' (Error loading tasks)' : ''}\n              </ListSubheader>\n            }\n          >\n            {tasks &&\n              tasks.map((task) => (\n                <ListItem key={task._id}>\n                  <Switch\n                    edge=\"start\"\n                    onChange={handleCompleteTask(task)}\n                    checked={task.completed}\n                  />\n                  <ListItemText primary={task.description} />\n                  <ListItemSecondaryAction>\n                    <IconButton onClick={handleDeleteTask(task)}>\n                      <DeleteIcon />\n                    </IconButton>\n                  </ListItemSecondaryAction>\n                </ListItem>\n              ))}\n          </List>\n        </Paper>\n      </Grid>\n    </>\n  );\n}\n","import { Backdrop, Grid, GridList, GridListTile, GridListTileBar, IconButton, ListSubheader, makeStyles, Paper } from '@material-ui/core';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport VideocamIcon from '@material-ui/icons/Videocam';\nimport React, { useContext, useState } from 'react';\nimport { addVideo, deleteVideo } from '../../api/db';\nimport { SnackBarContext } from '../../context/SnackBarProvider';\nimport { useGetVideosByOrderId } from './hooks';\n\nconst useStyles = makeStyles((theme) => ({\n  inputFile: {\n    display: 'none',\n  },\n  icon: {\n    color: 'rgba(255, 255, 255, 0.54)',\n  },\n  backdrop: {\n    zIndex: theme.zIndex.drawer + 1,\n    color: '#fff',\n  },\n  backdropContent: {\n    maxWidth: '95%',\n    maxHeight: '95%',\n  },\n}));\n\nexport default function VideoList({ orderId }) {\n  const classes = useStyles();\n\n  const { showSuccessAlert, showErrorAlert } = useContext(\n    SnackBarContext,\n  );\n\n  const [videos, isLoading, isError, reload] = useGetVideosByOrderId(\n    orderId,\n    [],\n  );\n  const [open, setOpen] = useState(false);\n  const [selectedVideo, setSelectedVideo] = useState('');\n\n  const handleClose = () => {\n    setSelectedVideo('');\n    setOpen(false);\n  };\n\n  const handleOpenVideo = (video) => () => {\n    // clicked video\n    setSelectedVideo(video);\n    // open backdrop\n    setOpen(!open);\n  };\n\n  const onChangeVideoUpload = async (event) => {\n    try {\n      const element = document.getElementById('input-video-file');\n      if (element.files && element.files[0]) {\n        await addVideo(orderId, element.files[0]);\n        reload();\n        // show message\n        showSuccessAlert('Video uploaded');\n      }\n    } catch (err) {\n      showErrorAlert(`Error uploading video (${err.message})`);\n    }\n  };\n\n  const handleDeleteVideo = (video) => async (event) => {\n    try {\n      // delete\n      await deleteVideo(video);\n      // reload videos\n      reload();\n      // show message\n      showSuccessAlert('Video removed');\n    } catch (err) {\n      showErrorAlert(`Error removing video (${err.message})`);\n    }\n  };\n\n  return (\n    <>\n      {/* BACKDROP */}\n\n      <Backdrop\n        className={classes.backdrop}\n        open={open}\n        onClick={handleClose}\n      >\n        {selectedVideo && (\n          <video controls className={classes.backdropContent}>\n            <source src={selectedVideo} />\n            <p>This browser does not support the video element</p>\n          </video>\n        )}\n      </Backdrop>\n\n      {/* ACTIONS */}\n\n      <Grid item container xs={12} direction=\"row\" justify=\"flex-end\">\n        <Grid item>\n          <input\n            type=\"file\"\n            accept=\"video/*\"\n            id=\"input-video-file\"\n            className={classes.inputFile}\n            onChange={onChangeVideoUpload}\n          />\n          <label htmlFor=\"input-video-file\">\n            <IconButton color=\"primary\" component=\"span\">\n              <VideocamIcon />\n            </IconButton>\n          </label>\n        </Grid>\n      </Grid>\n\n      {/* LIST */}\n\n      <Grid item xs={12}>\n        <Paper elevation={1}>\n          <GridList cellHeight={180} cols={3}>\n            <GridListTile\n              key=\"subheader-video\"\n              cols={3}\n              style={{ height: 'auto' }}\n            >\n              <ListSubheader\n                component=\"div\"\n                color=\"primary\"\n                style={{ backgroundColor: '#E5E5E5' }}\n              >\n                Videos\n                {!isLoading && videos.length === 0\n                  ? ' (No items to display)'\n                  : ''}\n                {isLoading ? ' (Loading...)' : ''}\n                {isError ? ' (Error loading videos)' : ''}\n              </ListSubheader>\n            </GridListTile>\n            {videos &&\n              videos.map((video) => {\n                const videoURL = URL.createObjectURL(\n                  video._attachments.file.data,\n                );\n                return (\n                  <GridListTile\n                    key={video._id}\n                    cols={1}\n                    onClick={handleOpenVideo(videoURL)}\n                  >\n                    <video height={180} controls={false}>\n                      <source\n                        type={video._attachments.file.content_type}\n                        src={videoURL}\n                      />\n                      <p>\n                        This browser does not support the video\n                        element\n                      </p>\n                    </video>\n                    <GridListTileBar\n                      title={video.name}\n                      actionIcon={\n                        <IconButton\n                          className={classes.icon}\n                          onClick={handleDeleteVideo(video)}\n                        >\n                          <DeleteIcon />\n                        </IconButton>\n                      }\n                    />\n                  </GridListTile>\n                );\n              })}\n          </GridList>\n        </Paper>\n      </Grid>\n    </>\n  );\n}\n","import { Grid, Typography } from '@material-ui/core';\nimport React from 'react';\nimport { useParams } from 'react-router-dom';\nimport { useGetOrderById } from './hooks';\nimport ImageList from './ImageList';\nimport TaskList from './TaskList';\nimport VideoList from './VideoList';\n\nexport default function OrderDetail() {\n  let { id } = useParams();\n\n  // states\n  const [order, isLoading, isError] = useGetOrderById(id);\n\n  return (\n    <div>\n      {isError && <div>Something went wrong ...</div>}\n      {isLoading && <div>Loading...</div>}\n      {!isLoading && !order && (\n        <Typography variant=\"subtitle1\">Order not found</Typography>\n      )}\n      {order && (\n        <Grid container spacing={2}>\n          <Grid item xs={12}>\n            <Typography variant=\"h5\">{order.description}</Typography>\n          </Grid>\n          <TaskList orderId={id} />\n          <ImageList orderId={id} />\n          <VideoList orderId={id} />\n        </Grid>\n      )}\n    </div>\n  );\n}\n","import { Grid, IconButton, List, ListItem, ListItemSecondaryAction, ListItemText, Paper, Typography } from '@material-ui/core';\nimport VisibilityIcon from '@material-ui/icons/Visibility';\nimport React from 'react';\nimport { Link, useRouteMatch } from 'react-router-dom';\nimport { useGetOrders } from './hooks';\n\nexport default function OrderList() {\n  const { url } = useRouteMatch();\n  const [orders, isLoading, isError] = useGetOrders([]);\n\n  return (\n    <div>\n      <Grid container spacing={2}>\n        <Grid item xs={12}>\n          <Typography variant=\"h5\">Work Orders</Typography>\n        </Grid>\n        <Grid item xs={12}>\n          {isError && <div>Something went wrong ...</div>}\n          {isLoading && <div>Loading...</div>}\n          {!isLoading && orders.length === 0 && (\n            <Typography variant=\"subtitle1\">\n              No orders to display\n            </Typography>\n          )}\n          {orders.length > 0 && (\n            <Paper elevation={1}>\n              <List>\n                {orders.map((order) => (\n                  <ListItem\n                    key={order._id}\n                    button\n                    component={Link}\n                    to={`${url}/${order._id}`}\n                  >\n                    <ListItemText\n                      primary={order.description}\n                      secondary={order.station}\n                    />\n                    <ListItemSecondaryAction>\n                      <IconButton color=\"inherit\">\n                        <VisibilityIcon />\n                      </IconButton>\n                    </ListItemSecondaryAction>\n                  </ListItem>\n                ))}\n              </List>\n            </Paper>\n          )}\n        </Grid>\n      </Grid>\n    </div>\n  );\n}\n","import React from 'react';\nimport { Route, Switch, useRouteMatch } from 'react-router-dom';\nimport OrderDetail from './OrderDetail';\nimport OrderList from './OrderList';\n\nexport default function OrderRouter() {\n  const { path } = useRouteMatch();\n\n  return (\n    <Switch>\n      <Route exact path={path}>\n        <OrderList />\n      </Route>\n      <Route path={`${path}/:id`}>\n        <OrderDetail />\n      </Route>\n    </Switch>\n  );\n}\n","import Container from '@material-ui/core/Container';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React from 'react';\nimport { HashRouter as Router, Route, Switch } from 'react-router-dom';\nimport Header from './components/header/Header';\nimport Home from './components/home/Home';\nimport OrderIndex from './components/orders/OrderIndex';\nimport { SnackBarProvider } from './context/SnackBarProvider';\n\nconst useStyles = makeStyles((theme) => ({\n  main: {\n    paddingTop: theme.spacing(2),\n    // [theme.breakpoints.down(\"xs\")]: {\n    //   padding: theme.spacing(2),\n    // },\n  },\n}));\n\nexport default function App() {\n  const classes = useStyles();\n\n  return (\n    <Router basename=\"/\">\n      <CssBaseline />\n      <SnackBarProvider>\n        <Header />\n        <Container maxWidth=\"md\">\n          <main className={classes.main}>\n            <Switch>\n              <Route exact path=\"/\">\n                <Home />\n              </Route>\n              <Route path=\"/orders\">\n                <OrderIndex />\n              </Route>\n            </Switch>\n          </main>\n        </Container>\n      </SnackBarProvider>\n    </Router>\n  );\n}\n","import AddToHomeScreen from 'a2hs.js';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css';\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root'),\n);\n\n// add to home screen\nAddToHomeScreen({\n  brandName: 'My Work',\n});\n","import AppBar from '@material-ui/core/AppBar';\nimport IconButton from '@material-ui/core/IconButton';\nimport { makeStyles } from '@material-ui/core/styles';\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport React, { useState } from 'react';\nimport HeaderDrawer from './HeaderDrawer';\nimport { HeaderWifiIcon } from './HeaderWifiIcon';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 1,\n  },\n  menuButton: {\n    marginRight: theme.spacing(2),\n  },\n  title: {\n    flexGrow: 1,\n  },\n}));\n\nexport default function Header() {\n  const classes = useStyles();\n  const iOS =\n    process.browser && /iPad|iPhone|iPod/.test(navigator.userAgent);\n  const [open, setOpen] = useState(false);\n\n  const toggleDrawer = (value) => (event) => {\n    if (\n      event &&\n      event.type === 'keydown' &&\n      (event.key === 'Tab' || event.key === 'Shift')\n    ) {\n      return;\n    }\n\n    if (open !== value) {\n      setOpen(value);\n    }\n  };\n\n  return (\n    <div className={classes.root}>\n      <AppBar position=\"static\">\n        <SwipeableDrawer\n          anchor=\"left\"\n          open={open}\n          onOpen={toggleDrawer(true)}\n          onClose={toggleDrawer(false)}\n          disableBackdropTransition={!iOS}\n          disableDiscovery={iOS}\n        >\n          <HeaderDrawer />\n        </SwipeableDrawer>\n        <Toolbar>\n          <IconButton\n            edge=\"start\"\n            className={classes.menuButton}\n            color=\"inherit\"\n            aria-label=\"menu\"\n            onClick={toggleDrawer(true)}\n          >\n            <MenuIcon />\n          </IconButton>\n          <Typography variant=\"h6\" className={classes.title}>\n            My Work App\n          </Typography>\n          <HeaderWifiIcon/>\n        </Toolbar>\n      </AppBar>\n    </div>\n  );\n}\n","import { List, ListItem, ListItemIcon, ListItemText, makeStyles } from '@material-ui/core';\nimport AssignmentIcon from '@material-ui/icons/Assignment';\nimport HomeIcon from '@material-ui/icons/Home';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { Link } from 'react-router-dom';\n\nfunction ListItemLink(props) {\n  const { icon, primary, to } = props;\n\n  const renderLink = React.useMemo(\n    () =>\n      React.forwardRef((itemProps, ref) => (\n        <Link to={to} ref={ref} {...itemProps} />\n      )),\n    [to],\n  );\n\n  return (\n    <li>\n      <ListItem button component={renderLink}>\n        {icon ? <ListItemIcon>{icon}</ListItemIcon> : null}\n        <ListItemText primary={primary} />\n      </ListItem>\n    </li>\n  );\n}\n\nListItemLink.propTypes = {\n  icon: PropTypes.element,\n  primary: PropTypes.string.isRequired,\n  to: PropTypes.string.isRequired,\n};\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 1,\n    width: 180,\n  },\n}));\n\nexport default function HeaderDrawer() {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <List>\n        <ListItemLink to=\"/\" primary=\"Home\" icon={<HomeIcon />} />\n        <ListItemLink\n          to=\"/orders\"\n          primary=\"Orders\"\n          icon={<AssignmentIcon />}\n        />\n      </List>\n    </div>\n  );\n}\n","import WifiIcon from '@material-ui/icons/Wifi';\nimport WifiOffIcon from '@material-ui/icons/WifiOff';\nimport React, { useEffect, useState } from 'react';\n\nconst REST_API_URL = process.env.REACT_APP_REST_API_ENDPOINT;\n\nexport const HeaderWifiIcon = () => {\n    const [isOnline, setIsOnline] = useState();\n\n    useEffect(() => {\n        window.addEventListener('online', checkInternet);\n        window.addEventListener('offline', checkInternet);\n        checkInternet();\n    },[])\n\n    const checkInternet = () => {\n        if (navigator.onLine) {\n            fetch(`${REST_API_URL}/orders`, {method: 'HEAD', mode: 'no-cors'}).then(function (resp) {\n                setIsOnline(resp && (resp.ok || resp.type === 'opaque') ? true : false)\n            }).catch(e => {\n                setIsOnline(false)\n            });\n        } else {\n            // handle offline status\n            setIsOnline(false)\n        }\n    }\n    return isOnline ? <WifiIcon/> : <WifiOffIcon/>\n}\n"],"sourceRoot":""}