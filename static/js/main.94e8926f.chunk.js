(this["webpackJsonptp-poc-reat-pwa"]=this["webpackJsonptp-poc-reat-pwa"]||[]).push([[0],{101:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(9),a=n(0),c=n.n(a),o=n(102),u=n.n(o),s=n(103),i=n.n(s),l=n(54),p=function(){var e=Object(a.useState)(),t=Object(r.a)(e,2),n=t[0],o=t[1];Object(a.useEffect)((function(){window.addEventListener("online",s),window.addEventListener("offline",s),s()}),[]);var s=function(){navigator.onLine?fetch("".concat(l.a,"/orders"),{method:"HEAD",mode:"no-cors"}).then((function(e){o(!(!e||!e.ok&&"opaque"!==e.type))})).catch((function(e){o(!1)})):o(!1)};return n?c.a.createElement(u.a,null):c.a.createElement(i.a,null)}},125:function(e,t,n){e.exports=n(149)},130:function(e,t,n){},149:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(12),o=n.n(c),u=(n(130),n(209)),s=n(210),i=n(114),l=n(37),p=n(42),f=n(93),d=n(9),m=n(55),b=n(197),v=n(4),h=n.n(v),x=n(7),E=n(32),O=n(36),w=n(113),y=n(62),j=n(77);function g(e,t,n,r){var a=e+t/60+n/3600;return"S"!==r&&"W"!==r||(a*=-1),a}var k=function(e){return new Promise((function(t,n){j.getData(e,(function(){var e=j.getAllTags(this);console.log("==>> EXIF ALL",e),t(function(e){var t=e.GPSLatitude,n=e.GPSLatitudeRef,r=e.GPSLongitude,a=e.GPSLongitudeRef;if(!t||!n||!r||!a)return null;var c=t[0],o=t[1],u=t[2],s=n,i=r[0],l=r[1],p=r[2],f=a;return{lat:g(c,o,u,s),lng:g(i,l,p,f),origin:"EXIF"}}(e))}))}))},S=function(){return new Promise((function(e,t){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){console.log(t),e({lat:t.coords.latitude,lng:t.coords.longitude,origin:"DEVICE"})}),(function(t){e(null)}),{timeout:1e4}):(console.log("Geolocation is not supported for this Browser/OS."),t())}))};y.characters("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$@"),O.a.plugin(w.a),O.a.on("destroyed",(function(e){console.log("==>> POUCHEDB destroyed",e)}));var C,I,A,_,D,N={_id:"default",downloadDisabled:!1,downloadedAt:"",uploadDisabled:!0,uploadedAt:"",deleteDisabled:!0,deletedAt:""};function L(){return P.apply(this,arguments)}function P(){return(P=Object(x.a)(h.a.mark((function e(){var t,n=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]&&n[0],C&&!t||(C=new O.a("sync-metadata")),e.abrupt("return",C);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return T.apply(this,arguments)}function T(){return(T=Object(x.a)(h.a.mark((function e(){var t,n=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]&&n[0],I&&!t){e.next=5;break}return I=new O.a("orders"),e.next=5,I.createIndex({index:{fields:["createdAt"]}});case 5:return e.abrupt("return",I);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(){return W.apply(this,arguments)}function W(){return(W=Object(x.a)(h.a.mark((function e(){var t,n=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]&&n[0],D&&!t){e.next=5;break}return D=new O.a("tasks"),e.next=5,D.createIndex({index:{fields:["createdAt","orderId"]}});case 5:return e.abrupt("return",D);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return B.apply(this,arguments)}function B(){return(B=Object(x.a)(h.a.mark((function e(){var t,n=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]&&n[0],A&&!t){e.next=5;break}return A=new O.a("images"),e.next=5,A.createIndex({index:{fields:["createdAt","orderId"]}});case 5:return e.abrupt("return",A);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){return z.apply(this,arguments)}function z(){return(z=Object(x.a)(h.a.mark((function e(){var t,n=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]&&n[0],_&&!t){e.next=5;break}return _=new O.a("videos"),e.next=5,_.createIndex({index:{fields:["createdAt","orderId"]}});case 5:return e.abrupt("return",_);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){return M.apply(this,arguments)}function M(){return(M=Object(x.a)(h.a.mark((function e(){var t,n,r,a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(L);case 2:return t=e.sent,e.next=5,V(F);case 5:return n=e.sent,e.next=8,V(R);case 8:return r=e.sent,e.next=11,V(H);case 11:return a=e.sent,e.next=14,V(G);case 14:return c=e.sent,e.abrupt("return",{metadata:t.ok,orders:n.ok,tasks:r.ok,images:a.ok,video:c.ok});case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){return $.apply(this,arguments)}function $(){return($=Object(x.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return n=e.sent,e.next=5,n.destroy();case 5:if(!(r=e.sent).ok){e.next=9;break}return e.next=9,t(!0);case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X("tasks",R);case 2:return e.next=4,X("images",H);case 4:return e.next=6,X("videos",G);case 6:return e.abrupt("return",Promise.resolve());case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(x.a)(h.a.mark((function e(t,n){var r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new O.a("https://tp-poc-pouchdb-server.herokuapp.com/".concat(t)),e.t0=console,e.next=4,r.info();case 4:return e.t1=e.sent,e.t0.log.call(e.t0,e.t1),e.next=8,n();case 8:return a=e.sent,e.abrupt("return",new Promise((function(e,n){a.replicate.to(r).on("complete",(function(){console.log(t,"SYNC COMPLETED"),e()})).on("error",(function(e){console.log(t,"SYNC ERROR"),console.error(e),n(e)}))})));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function Y(){return q.apply(this,arguments)}function q(){return(q=Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L();case 3:return t=e.sent,e.next=6,t.get("default");case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(0),!e.t0||"not_found"!==e.t0.name){e.next=13;break}return e.abrupt("return",N);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function K(e){return Q.apply(this,arguments)}function Q(){return(Q=Object(x.a)(h.a.mark((function e(t){var n,r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:return n=e.sent,e.next=5,Y();case 5:return r=e.sent,a=r&&r._rev?Object(E.a)({},t,{_rev:r._rev}):t,e.next=9,n.put(a);case 9:return e.next=11,n.get("default");case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(){return ee.apply(this,arguments)}function ee(){return(ee=Object(x.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:return t=e.sent,e.next=5,t.find({selector:{createdAt:{$gte:null}},sort:["createdAt"]});case 5:return n=e.sent,e.abrupt("return",n.docs);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){return ne.apply(this,arguments)}function ne(){return(ne=Object(x.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:return n=e.sent,e.next=5,n.get(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e){return ae.apply(this,arguments)}function ae(){return(ae=Object(x.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:return n=e.sent,e.next=5,n.put(t);case 5:return r=e.sent,e.abrupt("return",te(r.id));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e){return oe.apply(this,arguments)}function oe(){return(oe=Object(x.a)(h.a.mark((function e(t){var n,r,a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:return n=e.sent,e.next=5,n.find({selector:{orderId:t,createdAt:{$gte:null}},sort:["createdAt"]});case 5:return r=e.sent,a=r.docs.map((function(e){return e._id})),e.next=9,n.allDocs({keys:a,include_docs:!0});case 9:return c=e.sent,e.abrupt("return",c.rows.map((function(e){return e.doc})));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e){return se.apply(this,arguments)}function se(){return(se=Object(x.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:return n=e.sent,e.next=5,n.get(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e){return le.apply(this,arguments)}function le(){return(le=Object(x.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:return n=e.sent,e.next=5,n.put(Object(E.a)({},t,{_id:y.generate(),createdAt:(new Date).toISOString(),completed:!1}));case 5:return r=e.sent,e.abrupt("return",ue(r.id));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(e){return fe.apply(this,arguments)}function fe(){return(fe=Object(x.a)(h.a.mark((function e(t){var n,r,a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:return n=e.sent,e.next=5,ue(t._id);case 5:return r=e.sent,a=r._rev,e.next=9,n.put(Object(E.a)({},t,{_rev:a}));case 9:return c=e.sent,e.abrupt("return",ue(c.id));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e){return me.apply(this,arguments)}function me(){return(me=Object(x.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:return n=e.sent,e.next=5,n.get(t._id);case 5:return r=e.sent,e.abrupt("return",n.remove(r));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e){return ve.apply(this,arguments)}function ve(){return(ve=Object(x.a)(h.a.mark((function e(t){var n,r,a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H();case 2:return n=e.sent,e.next=5,n.find({selector:{orderId:t,createdAt:{$gte:null}},sort:["createdAt"]});case 5:return r=e.sent,a=r.docs.map((function(e){return e._id})),e.next=9,n.allDocs({keys:a,include_docs:!0,attachments:!0,binary:!0});case 9:return c=e.sent,e.abrupt("return",c.rows.map((function(e){return e.doc})));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e){return xe.apply(this,arguments)}function xe(){return(xe=Object(x.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H();case 2:return n=e.sent,e.next=5,n.get(t,{attachments:!0,binary:!0});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(e,t){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(x.a)(h.a.mark((function e(t,n){var r,a,c,o,u,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H();case 2:return r=e.sent,a=n.name,c=n.type,e.next=6,k(n);case 6:if(o=e.sent){e.next=11;break}return e.next=10,S();case 10:o=e.sent;case 11:return u={_id:y.generate(),orderId:t,name:a,location:o,createdAt:(new Date).toISOString(),_attachments:{file:{content_type:c,data:n}}},e.next=14,r.put(u);case 14:return s=e.sent,e.abrupt("return",he(s.id));case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(e){return ye.apply(this,arguments)}function ye(){return(ye=Object(x.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H();case 2:return n=e.sent,e.next=5,n.get(t._id);case 5:return r=e.sent,e.abrupt("return",n.remove(r));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function je(e){return ge.apply(this,arguments)}function ge(){return(ge=Object(x.a)(h.a.mark((function e(t){var n,r,a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G();case 2:return n=e.sent,e.next=5,n.find({selector:{orderId:t,createdAt:{$gte:null}},sort:["createdAt"]});case 5:return r=e.sent,a=r.docs.map((function(e){return e._id})),e.next=9,n.allDocs({keys:a,include_docs:!0,attachments:!0,binary:!0});case 9:return c=e.sent,e.abrupt("return",c.rows.map((function(e){return e.doc})));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(e){return Se.apply(this,arguments)}function Se(){return(Se=Object(x.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G();case 2:return n=e.sent,e.next=5,n.get(t,{attachments:!0,binary:!0});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ce(e,t){return Ie.apply(this,arguments)}function Ie(){return(Ie=Object(x.a)(h.a.mark((function e(t,n){var r,a,c,o,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G();case 2:return r=e.sent,a=n.name,c=n.type,o={_id:y.generate(),orderId:t,name:a,createdAt:(new Date).toISOString(),_attachments:{file:{content_type:c,data:n}}},e.next=7,r.put(o);case 7:return u=e.sent,e.abrupt("return",ke(u.id));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(e){return _e.apply(this,arguments)}function _e(){return(_e=Object(x.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G();case 2:return n=e.sent,e.next=5,n.get(t._id);case 5:return r=e.sent,e.abrupt("return",n.remove(r));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var De=n(155),Ne=n(157),Le=n(115),Pe=n(198),Fe=n(199),Te=n(200),Re=n(201),We=n(106),He=n.n(We),Be=n(39),Ge=n.n(Be),ze=n(213),Ue=n(212),Me=Object(r.createContext)();function Ve(e){var t=e.children,n=Object(r.useState)("info"),c=Object(d.a)(n,2),o=c[0],u=c[1],s=Object(r.useState)(""),i=Object(d.a)(s,2),l=i[0],p=i[1],f=Object(r.useState)(!1),m=Object(d.a)(f,2),b=m[0],v=m[1],h=function(e,t){p(e),u("success"),v(!0)},x=function(e,t){"clickaway"!==t&&v(!1)},E={showInfoAlert:function(e){return h(e)},showSuccessAlert:function(e){return h(e)},showWarningAlert:function(e){return h(e)},showErrorAlert:function(e){return h(e)}};return a.a.createElement(a.a.Fragment,null,a.a.createElement(Me.Provider,{value:E},t,a.a.createElement(ze.a,{message:l,open:b,autoHideDuration:6e3,onClose:x},a.a.createElement(Ue.a,{elevation:6,variant:"filled",onClose:x,severity:o},l))))}var $e=Object(i.a)((function(e){return{inputFile:{display:"none"},icon:{color:"rgba(255, 255, 255, 0.54)"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},backdropContent:{maxWidth:"95%",maxHeight:"95%"}}}));function Je(e){var t=e.orderId,n=$e(),c=Object(r.useContext)(Me),o=c.showSuccessAlert,u=c.showErrorAlert,s=function(e,t){var n=Object(r.useState)(!1),a=Object(d.a)(n,2),c=a[0],o=a[1],u=Object(r.useState)(!1),s=Object(d.a)(u,2),i=s[0],l=s[1],p=Object(r.useState)(t),f=Object(d.a)(p,2),m=f[0],b=f[1],v=Object(r.useState)(0),E=Object(d.a)(v,2),O=E[0],w=E[1];return Object(r.useEffect)((function(){function t(){return(t=Object(x.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l(!0),o(!1),t.prev=2,t.t0=b,t.next=6,be(e);case 6:t.t1=t.sent,(0,t.t0)(t.t1),t.next=14;break;case 10:t.prev=10,t.t2=t.catch(2),console.error(t.t2),o(!0);case 14:l(!1);case 15:case"end":return t.stop()}}),t,null,[[2,10]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e,O]),[m,i,c,function(){w(Date.now().valueOf())}]}(t,[]),i=Object(d.a)(s,4),l=i[0],p=i[1],f=i[2],m=i[3],v=Object(r.useState)(!1),E=Object(d.a)(v,2),O=E[0],w=E[1],y=Object(r.useState)(!1),j=Object(d.a)(y,2),g=j[0],k=j[1],S=function(e){return function(){k(e),w(!O)}},C=function(){var e=Object(x.a)(h.a.mark((function e(n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=document.getElementById("input-image-file")).files||!r.files[0]){e.next=7;break}return e.next=5,Ee(t,r.files[0]);case 5:m(),o("Image uploaded");case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),u("Error uploading image (".concat(e.t0.message,")"));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),I=function(e){return function(){var t=Object(x.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,we(e);case 3:m(),o("Image removed"),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),u("Error removing image (".concat(t.t0.message,")"));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()};return a.a.createElement(a.a.Fragment,null,a.a.createElement(De.a,{className:n.backdrop,open:O,onClick:function(){w(!1)}},g&&a.a.createElement("img",{className:n.backdropContent,src:g,alt:""})),a.a.createElement(b.a,{item:!0,container:!0,xs:12,direction:"row",justify:"flex-end"},a.a.createElement(b.a,{item:!0},a.a.createElement("input",{type:"file",accept:"image/*",id:"input-image-file",className:n.inputFile,onChange:C}),a.a.createElement("label",{htmlFor:"input-image-file"},a.a.createElement(Ne.a,{color:"primary",component:"span"},a.a.createElement(He.a,null))))),a.a.createElement(b.a,{item:!0,xs:12},a.a.createElement(Le.a,{elevation:1},a.a.createElement(Pe.a,{cellHeight:180,cols:3},a.a.createElement(Fe.a,{key:"subheader-image",cols:3,style:{height:"auto"}},a.a.createElement(Te.a,{component:"div",color:"primary",style:{backgroundColor:"#E5E5E5"}},"Images",p||0!==l.length?"":" (No items to display)",p?" (Loading...)":"",f?" (Error loading images)":"")),l&&l.map((function(e){var t=URL.createObjectURL(e._attachments.file.data);return a.a.createElement(Fe.a,{key:e._id,cols:1,onClick:S(t)},a.a.createElement("img",{src:t,alt:e.name}),a.a.createElement(Re.a,{title:e.name,subtitle:e.location?"".concat(e.location.lat,", ").concat(e.location.lng):"No location",actionIcon:a.a.createElement(Ne.a,{className:n.icon,onClick:I(e)},a.a.createElement(Ge.a,null))}))}))))))}var Xe=n(107),Ye=n.n(Xe),qe=Object(i.a)((function(e){return{inputFile:{display:"none"},icon:{color:"rgba(255, 255, 255, 0.54)"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},backdropContent:{maxWidth:"95%",maxHeight:"95%"}}}));function Ke(e){var t=e.orderId,n=qe(),c=Object(r.useContext)(Me),o=c.showSuccessAlert,u=c.showErrorAlert,s=function(e,t){var n=Object(r.useState)(!1),a=Object(d.a)(n,2),c=a[0],o=a[1],u=Object(r.useState)(!1),s=Object(d.a)(u,2),i=s[0],l=s[1],p=Object(r.useState)(t),f=Object(d.a)(p,2),m=f[0],b=f[1],v=Object(r.useState)(0),E=Object(d.a)(v,2),O=E[0],w=E[1];return Object(r.useEffect)((function(){function t(){return(t=Object(x.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l(!0),o(!1),t.prev=2,t.t0=b,t.next=6,je(e);case 6:t.t1=t.sent,(0,t.t0)(t.t1),t.next=14;break;case 10:t.prev=10,t.t2=t.catch(2),console.error(t.t2),o(!0);case 14:l(!1);case 15:case"end":return t.stop()}}),t,null,[[2,10]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e,O]),[m,i,c,function(){w(Date.now().valueOf())}]}(t,[]),i=Object(d.a)(s,4),l=i[0],p=i[1],f=i[2],m=i[3],v=Object(r.useState)(!1),E=Object(d.a)(v,2),O=E[0],w=E[1],y=Object(r.useState)(""),j=Object(d.a)(y,2),g=j[0],k=j[1],S=function(e){return function(){k(e),w(!O)}},C=function(){var e=Object(x.a)(h.a.mark((function e(n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=document.getElementById("input-video-file")).files||!r.files[0]){e.next=7;break}return e.next=5,Ce(t,r.files[0]);case 5:m(),o("Video uploaded");case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),u("Error uploading video (".concat(e.t0.message,")"));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),I=function(e){return function(){var t=Object(x.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ae(e);case 3:m(),o("Video removed"),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),u("Error removing video (".concat(t.t0.message,")"));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()};return a.a.createElement(a.a.Fragment,null,a.a.createElement(De.a,{className:n.backdrop,open:O,onClick:function(){k(""),w(!1)}},g&&a.a.createElement("video",{controls:!0,className:n.backdropContent},a.a.createElement("source",{src:g}),a.a.createElement("p",null,"This browser does not support the video element"))),a.a.createElement(b.a,{item:!0,container:!0,xs:12,direction:"row",justify:"flex-end"},a.a.createElement(b.a,{item:!0},a.a.createElement("input",{type:"file",accept:"video/*",id:"input-video-file",className:n.inputFile,onChange:C}),a.a.createElement("label",{htmlFor:"input-video-file"},a.a.createElement(Ne.a,{color:"primary",component:"span"},a.a.createElement(Ye.a,null))))),a.a.createElement(b.a,{item:!0,xs:12},a.a.createElement(Le.a,{elevation:1},a.a.createElement(Pe.a,{cellHeight:180,cols:3},a.a.createElement(Fe.a,{key:"subheader-video",cols:3,style:{height:"auto"}},a.a.createElement(Te.a,{component:"div",color:"primary",style:{backgroundColor:"#E5E5E5"}},"Videos",p||0!==l.length?"":" (No items to display)",p?" (Loading...)":"",f?" (Error loading videos)":"")),l&&l.map((function(e){var t=URL.createObjectURL(e._attachments.file.data);return a.a.createElement(Fe.a,{key:e._id,cols:1,onClick:S(t)},a.a.createElement("video",{height:180,controls:!1},a.a.createElement("source",{type:e._attachments.file.content_type,src:t}),a.a.createElement("p",null,"This browser does not support the video element")),a.a.createElement(Re.a,{title:e.name,actionIcon:a.a.createElement(Ne.a,{className:n.icon,onClick:I(e)},a.a.createElement(Ge.a,null))}))}))))))}var Qe=n(202),Ze=n(203),et=n(204),tt=n(211),nt=n(205),rt=n(206),at=n(153),ct=n(150),ot=n(214),ut=n(152),st=n(207),it=n(108),lt=n.n(it);function pt(e){var t=e.orderId,n=Object(r.useContext)(Me),c=n.showSuccessAlert,o=n.showErrorAlert,u=function(e,t){var n=Object(r.useState)(!1),a=Object(d.a)(n,2),c=a[0],o=a[1],u=Object(r.useState)(!1),s=Object(d.a)(u,2),i=s[0],l=s[1],p=Object(r.useState)(t),f=Object(d.a)(p,2),m=f[0],b=f[1],v=Object(r.useState)(0),E=Object(d.a)(v,2),O=E[0],w=E[1];return Object(r.useEffect)((function(){function t(){return(t=Object(x.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l(!0),o(!1),t.prev=2,t.t0=b,t.next=6,ce(e);case 6:t.t1=t.sent,(0,t.t0)(t.t1),t.next=14;break;case 10:t.prev=10,t.t2=t.catch(2),console.error(t.t2),o(!0);case 14:l(!1);case 15:case"end":return t.stop()}}),t,null,[[2,10]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e,O]),[m,i,c,function(){w(Date.now().valueOf())}]}(t,[]),s=Object(d.a)(u,4),i=s[0],l=s[1],p=s[2],f=s[3],m=Object(r.useState)(!1),v=Object(d.a)(m,2),O=v[0],w=v[1],y=Object(r.useState)(!1),j=Object(d.a)(y,2),g=j[0],k=j[1],S=function(){w(!1)},C=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ie({orderId:t,description:g});case 3:S(),f(),c("Task added"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),o("Error addding task (".concat(e.t0.message,")"));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),I=function(e){return function(){var t=Object(x.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,pe(Object(E.a)({},e,{completed:n.target.checked}));case 3:f(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),o("Error completiing task (".concat(t.t0.message,")"));case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()},A=function(e){return function(){var t=Object(x.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,de(e);case 3:f(),c("Task removed"),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),o("Error removing task (".concat(t.t0.message,")"));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()};return a.a.createElement(a.a.Fragment,null,a.a.createElement(b.a,{item:!0,container:!0,xs:12,direction:"row",justify:"flex-end"},a.a.createElement(b.a,{item:!0},a.a.createElement(Ne.a,{color:"primary",component:"span",onClick:function(){w(!0)}},a.a.createElement(lt.a,null)))),a.a.createElement(Qe.a,{open:O,onClose:S,fullWidth:!0},a.a.createElement(Ze.a,{style:{backgroundColor:"#E5E5E5"}},"New Task"),a.a.createElement(et.a,null,a.a.createElement(tt.a,{autoFocus:!0,id:"description",label:"Description",fullWidth:!0,onChange:function(e){k(e.target.value)}})),a.a.createElement(nt.a,null,a.a.createElement(rt.a,{onClick:S,color:"primary"},"Cancel"),a.a.createElement(rt.a,{onClick:C,color:"primary"},"Add Task"))),a.a.createElement(b.a,{item:!0,xs:12},a.a.createElement(Le.a,{elevation:1},a.a.createElement(at.a,{subheader:a.a.createElement(Te.a,{color:"primary",style:{backgroundColor:"#E5E5E5"}},"Tasks",l||0!==i.length?"":" (No items to display)",l?" (Loading...)":"",p?" (Error loading tasks)":"")},i&&i.map((function(e){return a.a.createElement(ct.a,{key:e._id},a.a.createElement(ot.a,{edge:"start",onChange:I(e),checked:e.completed}),a.a.createElement(ut.a,{primary:e.description}),a.a.createElement(st.a,null,a.a.createElement(Ne.a,{onClick:A(e)},a.a.createElement(Ge.a,null))))}))))))}function ft(){var e=Object(p.f)().id,t=function(e,t){var n=Object(r.useState)(!1),a=Object(d.a)(n,2),c=a[0],o=a[1],u=Object(r.useState)(!1),s=Object(d.a)(u,2),i=s[0],l=s[1],p=Object(r.useState)(t),f=Object(d.a)(p,2),m=f[0],b=f[1],v=Object(r.useState)(0),E=Object(d.a)(v,2),O=E[0],w=E[1];return Object(r.useEffect)((function(){function t(){return(t=Object(x.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l(!0),o(!1),t.prev=2,t.t0=b,t.next=6,te(e);case 6:t.t1=t.sent,(0,t.t0)(t.t1),t.next=14;break;case 10:t.prev=10,t.t2=t.catch(2),console.error(t.t2),o(!0);case 14:l(!1);case 15:case"end":return t.stop()}}),t,null,[[2,10]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e,O]),[m,i,c,function(){w(Date.now().valueOf())}]}(e),n=Object(d.a)(t,3),c=n[0],o=n[1],u=n[2];return a.a.createElement("div",null,u&&a.a.createElement("div",null,"Something went wrong ..."),o&&a.a.createElement("div",null,"Loading..."),!o&&!c&&a.a.createElement(m.a,{variant:"subtitle1"},"Order not found"),c&&a.a.createElement(b.a,{container:!0,spacing:2},a.a.createElement(b.a,{item:!0,xs:12},a.a.createElement(m.a,{variant:"h5"},c.description)),a.a.createElement(pt,{orderId:e}),a.a.createElement(Je,{orderId:e}),a.a.createElement(Ke,{orderId:e})))}var dt=n(109),mt=n.n(dt);function bt(){var e=Object(p.g)().url,t=function(e){var t=Object(r.useState)(!1),n=Object(d.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)(!1),u=Object(d.a)(o,2),s=u[0],i=u[1],l=Object(r.useState)(e),p=Object(d.a)(l,2),f=p[0],m=p[1],b=Object(r.useState)(0),v=Object(d.a)(b,2),E=v[0],O=v[1];return Object(r.useEffect)((function(){function e(){return(e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),c(!1),e.prev=2,e.t0=m,e.next=6,Z();case 6:e.t1=e.sent,(0,e.t0)(e.t1),e.next=14;break;case 10:e.prev=10,e.t2=e.catch(2),console.error(e.t2),c(!0);case 14:i(!1);case 15:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[E]),[f,s,a,function(){O(Date.now().valueOf())}]}([]),n=Object(d.a)(t,3),c=n[0],o=n[1],u=n[2];return a.a.createElement("div",null,a.a.createElement(b.a,{container:!0,spacing:2},a.a.createElement(b.a,{item:!0,xs:12},a.a.createElement(m.a,{variant:"h5"},"Work Orders")),a.a.createElement(b.a,{item:!0,xs:12},u&&a.a.createElement("div",null,"Something went wrong ..."),o&&a.a.createElement("div",null,"Loading..."),!o&&0===c.length&&a.a.createElement(m.a,{variant:"subtitle1"},"No orders to display"),c.length>0&&a.a.createElement(Le.a,{elevation:1},a.a.createElement(at.a,null,c.map((function(t){return a.a.createElement(ct.a,{key:t._id,button:!0,component:l.b,to:"".concat(e,"/").concat(t._id)},a.a.createElement(ut.a,{primary:t.description,secondary:t.station}),a.a.createElement(st.a,null,a.a.createElement(Ne.a,{color:"inherit"},a.a.createElement(mt.a,null))))})))))))}function vt(){var e=Object(p.g)().path;return a.a.createElement(p.c,null,a.a.createElement(p.a,{exact:!0,path:e},a.a.createElement(bt,null)),a.a.createElement(p.a,{path:"".concat(e,"/:id")},a.a.createElement(ft,null)))}var ht=n(208),xt=n(111),Et=n.n(xt),Ot=n(110),wt=n.n(Ot),yt=n(54);function jt(){return gt.apply(this,arguments)}function gt(){return(gt=Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(yt.a,"/orders"));case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kt(e){return St.apply(this,arguments)}function St(){return(St=Object(x.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(yt.a,"/tasks/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ct(){var e=Object(r.useContext)(Me),t=e.showSuccessAlert,n=e.showErrorAlert,c=Object(r.useState)(N),o=Object(d.a)(c,2),u=o[0],s=o[1],i=Object(r.useState)(!1),l=Object(d.a)(i,2),p=l[0],f=l[1];Object(r.useEffect)((function(){function e(){return(e=Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y();case 3:t=e.sent,s(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var v=function(){var e=Object(x.a)(h.a.mark((function e(r){var a,c,o,i,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,f(!0),e.next=4,jt();case 4:if(!((a=e.sent).length>0)){e.next=19;break}return e.next=8,Promise.all(a.map((function(e){return re(Object(E.a)({},e,{_id:e.id}))})));case 8:return c=e.sent,o=c.map((function(e){return e._id})),e.next=12,Promise.all(o.map((function(e){return kt(e)})));case 12:return i=e.sent,e.next=15,Promise.all(i.flat().map((function(e){return ie(Object(E.a)({},e,{_id:ie.id}))})));case 15:return e.next=17,K(Object(E.a)({},u,{downloadDisabled:!0,uploadDisabled:!1,deleteDisabled:!1}));case 17:l=e.sent,s(l);case 19:t("Data loaded from server successfuly"),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(0),n("Error loading data from server"),console.error(e.t0);case 26:return e.prev=26,f(!1),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[0,22,26,29]])})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(x.a)(h.a.mark((function e(r){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,f(!0),e.next=4,J();case 4:return e.next=6,K(Object(E.a)({},u,{downloadDisabled:!0,uploadDisabled:!0,deleteDisabled:!1}));case 6:a=e.sent,s(a),t("Data synced back to server successfuly"),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),n("Error syncing data back to server"),console.error(e.t0);case 15:return e.prev=15,f(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,11,15,18]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(x.a)(h.a.mark((function e(r){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,f(!0),e.next=4,U();case 4:return a=e.sent,console.log(a),e.t0=s,e.next=9,Y();case 9:e.t1=e.sent,(0,e.t0)(e.t1),t("Local database cleaned successfuly"),e.next=18;break;case 14:e.prev=14,e.t2=e.catch(0),n("Error cleaning local database"),console.error(e.t2);case 18:return e.prev=18,f(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[0,14,18,21]])})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement(b.a,{container:!0,spacing:2},a.a.createElement(b.a,{item:!0,xs:12},a.a.createElement(m.a,{variant:"h5"},"Home")),a.a.createElement(b.a,{item:!0,xs:12},a.a.createElement(rt.a,{variant:"contained",color:"default",startIcon:a.a.createElement(wt.a,null),onClick:v,disabled:u.downloadDisabled||p},"Load data from server")),a.a.createElement(b.a,{item:!0,xs:12},a.a.createElement(rt.a,{variant:"contained",color:"default",startIcon:a.a.createElement(Et.a,null),onClick:O,disabled:u.uploadDisabled||p},"Sync local data to server")),a.a.createElement(b.a,{item:!0,xs:12},a.a.createElement(rt.a,{variant:"contained",color:"default",startIcon:a.a.createElement(Ge.a,null),onClick:w,disabled:u.deleteDisabled||p},"Clean my local data")),p&&a.a.createElement(b.a,{item:!0,xs:12,container:!0,direction:"column",justify:"center",alignItems:"center"},a.a.createElement(ht.a,{size:40,style:{marginTop:50}}))))}var It=Object(i.a)((function(e){return{main:{paddingTop:e.spacing(2)}}}));function At(){var e=It();return a.a.createElement(l.a,{basename:"/"},a.a.createElement(u.a,null),a.a.createElement(Ve,null,a.a.createElement(f.a,null),a.a.createElement(s.a,{maxWidth:"md"},a.a.createElement("main",{className:e.main},a.a.createElement(p.c,null,a.a.createElement(p.a,{exact:!0,path:"/"},a.a.createElement(Ct,null)),a.a.createElement(p.a,{path:"/orders"},a.a.createElement(vt,null)))))))}var _t=n(112),Dt=n.n(_t);o.a.render(a.a.createElement(At,null),document.getElementById("root")),Dt()({brandName:"My Work"})},54:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="https://tp-poc-api.herokuapp.com/api"},93:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var r=n(9),a=n(0),c=n.n(a),o=n(114),u=n(154),s=n(156),i=n(55),l=n(157),p=n(104),f=n.n(p),d=n(160),m=n(94),b=n(101),v=Object(o.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function h(){var t=v(),n=e.browser&&/iPad|iPhone|iPod/.test(navigator.userAgent),o=Object(a.useState)(!1),p=Object(r.a)(o,2),h=p[0],x=p[1],E=function(e){return function(t){(!t||"keydown"!==t.type||"Tab"!==t.key&&"Shift"!==t.key)&&h!==e&&x(e)}};return c.a.createElement("div",{className:t.root},c.a.createElement(u.a,{position:"static"},c.a.createElement(d.a,{anchor:"left",open:h,onOpen:E(!0),onClose:E(!1),disableBackdropTransition:!n,disableDiscovery:n},c.a.createElement(m.a,null)),c.a.createElement(s.a,null,c.a.createElement(l.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",onClick:E(!0)},c.a.createElement(f.a,null)),c.a.createElement(i.a,{variant:"h6",className:t.title},"My Work App"),c.a.createElement(b.a,null))))}}).call(this,n(87))},94:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(0),a=n.n(r),c=n(150),o=n(151),u=n(152),s=n(114),i=n(153),l=n(99),p=n.n(l),f=n(100),d=n.n(f),m=n(37);function b(e){var t=e.icon,n=e.primary,r=e.to,s=a.a.useMemo((function(){return a.a.forwardRef((function(e,t){return a.a.createElement(m.b,Object.assign({to:r,ref:t},e))}))}),[r]);return a.a.createElement("li",null,a.a.createElement(c.a,{button:!0,component:s},t?a.a.createElement(o.a,null,t):null,a.a.createElement(u.a,{primary:n})))}var v=Object(s.a)((function(e){return{root:{flexGrow:1,width:180}}}));function h(){var e=v();return a.a.createElement("div",{className:e.root},a.a.createElement(i.a,null,a.a.createElement(b,{to:"/",primary:"Home",icon:a.a.createElement(p.a,null)}),a.a.createElement(b,{to:"/orders",primary:"Orders",icon:a.a.createElement(d.a,null)})))}}},[[125,1,2]]]);
//# sourceMappingURL=main.94e8926f.chunk.js.map